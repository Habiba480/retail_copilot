{"question": "What are the top 3 products by revenue?", "final_answer": [{"product": "C\u00f4te de Blaye", "revenue": 53265895.235}, {"product": "Th\u00fcringer Rostbratwurst", "revenue": 24623469.231999934}, {"product": "Mishi Kobe Niku", "revenue": 19423037.5}], "sql": "\n                SELECT P.ProductName AS product,\n                       SUM(OD.UnitPrice * OD.Quantity * (1 - OD.Discount)) AS revenue\n                FROM \"Order Details\" OD\n                JOIN Products P ON P.ProductID = OD.ProductID\n                GROUP BY P.ProductID\n                ORDER BY revenue DESC\n                LIMIT 3\n            ", "citations": ["catalog::chunk11", "catalog::chunk5", "product_policy::chunk2", "Orders", "Order Details", "Products", "Customers"]}
{"question": "What is the average order value for summer beverages 1997?", "final_answer": 0.0, "sql": "\n                SELECT ROUND(SUM(OD.UnitPrice * OD.Quantity * (1 - OD.Discount)) / COUNT(DISTINCT O.OrderID), 2) AS aov\n                FROM Orders O\n                JOIN \"Order Details\" OD ON O.OrderID = OD.OrderID\n                WHERE O.OrderDate BETWEEN '1997-06-01' AND '1997-06-30'\n            ", "citations": ["kpi_definitions::chunk1", "marketing_calendar::chunk1", "marketing_calendar::chunk3", "Orders", "Order Details", "Products", "Customers"]}
{"question": "What is the total revenue from Winter Classics 1997?", "final_answer": 0.0, "sql": "\n                SELECT ROUND(SUM(OD.UnitPrice * OD.Quantity * (1 - OD.Discount)), 2) AS revenue\n                FROM \"Order Details\" OD\n                JOIN Products P ON P.ProductID = OD.ProductID\n                JOIN Orders O ON O.OrderID = OD.OrderID\n                WHERE P.CategoryID = (SELECT CategoryID FROM Products\n                                      JOIN Categories C ON C.CategoryID = Products.CategoryID\n                                      WHERE C.CategoryName = 'Beverages')\n                  AND O.OrderDate BETWEEN '1997-12-01' AND '1997-12-31'\n            ", "citations": ["marketing_calendar::chunk4", "catalog::chunk11", "catalog::chunk10", "Orders", "Order Details", "Products", "Customers"]}
{"question": "Who is the top customer by gross margin?", "final_answer": "", "sql": "\n                SELECT C.CompanyName AS customer,\n                       ROUND(SUM((OD.UnitPrice * 0.3) * OD.Quantity * (1 - OD.Discount)), 2) AS margin\n                FROM Orders O\n                JOIN \"Order Details\" OD ON O.OrderID = OD.OrderID\n                JOIN Customers C ON C.CustomerID = O.CustomerID\n                WHERE O.OrderDate BETWEEN '1997-01-01' AND '1997-12-31'\n                GROUP BY C.CustomerID\n                ORDER BY margin DESC\n                LIMIT 1\n            ", "citations": ["kpi_definitions::chunk5", "catalog::chunk11", "catalog::chunk10", "Orders", "Order Details", "Products", "Customers"]}
{"question": "What is the return policy for Beverages?", "final_answer": "", "sql": "", "citations": ["product_policy::chunk0", "catalog::chunk11", "product_policy::chunk1", "Orders", "Order Details", "Products", "Customers"]}
{"question": "What is the gross margin for Condiments in 1997?", "final_answer": 0.0, "sql": "\n                SELECT C.CompanyName AS customer,\n                       ROUND(SUM((OD.UnitPrice * 0.3) * OD.Quantity * (1 - OD.Discount)), 2) AS margin\n                FROM Orders O\n                JOIN \"Order Details\" OD ON O.OrderID = OD.OrderID\n                JOIN Customers C ON C.CustomerID = O.CustomerID\n                WHERE O.OrderDate BETWEEN '1997-01-01' AND '1997-12-31'\n                GROUP BY C.CustomerID\n                ORDER BY margin DESC\n                LIMIT 1\n            ", "citations": ["kpi_definitions::chunk5", "catalog::chunk11", "catalog::chunk3", "Orders", "Order Details", "Products", "Customers"]}
